<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(~{::body})}">
<body>

<section class="max-w-3xl mx-auto space-y-6 p-6">

    <!-- Название и автор -->
    <div class="p-6 bg-white/60 rounded-2xl shadow-soft">
        <h1 class="font-serif text-3xl mb-2" th:text="${book.getTitle()}">Название книги</h1>
        <h2 class="text-lg opacity-80 mb-1" th:text="'Автор: ' + ${book.getAuthor()}">Автор</h2>
        <p class="text-sm opacity-60" th:text="'Год издания: ' + ${book.getReleaseDate()}">Год</p>
    </div>

    <!-- Информация о владельце -->
    <div th:if="${owner}" class="p-5 bg-white/60 rounded-2xl shadow-soft space-y-3">
        <p class="opacity-80">Книга сейчас у:</p>
        <p class="font-medium" th:text="${owner.getName()}">Имя человека</p>

        <form th:method="PATCH" th:action="@{/books/{id}/absolve(id=${book.getId()})}">
            <button type="submit"
                    class="px-4 py-2 rounded-xl bg-red-100 hover:bg-red-200 transition">
                Освободить книгу
            </button>
        </form>
    </div>

    <!-- Назначение книги -->
    <div th:if="${people}" class="p-5 bg-white/60 rounded-2xl shadow-soft space-y-3">
        <p class="opacity-80">Эта книга свободна. Кому назначить ее?</p>

        <form th:method="PATCH" th:action="@{/books/{id}/assign(id=${book.getId()})}" class="space-y-2">
            <label for="person" class="block text-sm opacity-80">Выберите человека</label>
            <select th:object="${person}" th:field="*{id}" id="person"
                    class="w-full p-2 rounded-lg border border-gray-300">
                <option th:each="person : ${people}" th:value="${person.getId()}" th:text="${person.getName()}"></option>
            </select>
            <button type="submit" class="px-4 py-2 rounded-xl bg-green-100 hover:bg-green-200 transition">
                Назначить книгу
            </button>
        </form>
    </div>

    <hr/>

    <!-- Действия: редактировать / удалить -->
    <div class="flex gap-4">
        <form th:method="GET" th:action="@{/books/{id}/edit(id=${book.getId()})}">
            <button type="submit" class="px-4 py-2 rounded-xl bg-blue-100 hover:bg-blue-200 transition">
                Редактировать
            </button>
        </form>

        <form th:method="DELETE" th:action="@{/books/{id}(id=${book.getId()})}">
            <button type="submit" class="px-4 py-2 rounded-xl bg-red-100 hover:bg-red-200 transition">
                Удалить
            </button>
        </form>
    </div>

</section>

</body>
</html>
